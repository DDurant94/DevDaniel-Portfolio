/**
 * Contact Aside Panel - Right-side slide-out with glassmorphic background
 */

/**
 * Components:
 * - Wrapper: Fixed overlay container (z-index 2100)
 * - Backdrop: Blurred overlay with click-to-close
 * - Aside Panel: Right-sliding drawer with form
 * - Header: Title and close button
 * - Body: Scrollable form content
 * 
 * Animations:
 * - Enter: Slide from right (8% → 0) + fade in (0.55s spring)
 * - Exit: Slide to right (0 → 8%) + fade out (0.4s spring)
 * - Easing: Spring curves for natural motion
 * 
 * Visual Design:
 * - Width: clamp(300px, 38vw, 480px)
 * - Background: --color-surface-elevated with glass effect
 * - Border-left: Subtle separator
 * - Shadow: --shadow-panel for depth
 * - Backdrop: Blur(4px) + saturate(140%)
 * 
 * Layout:
 * - Fixed positioning (inset: 0)
 * - Flexbox column for header/body
 * - Header: Sticky with close button
 * - Body: Scrollable overflow-y auto
 * 
 * Header:
 * - Sticky positioning
 * - Padding: 2rem 1.5rem 1.5rem
 * - Close button: Top-right with hover/focus states
 * - Border-bottom: Subtle separator
 * 
 * Body:
 * - Padding: 1.5rem
 * - Overflow-y: auto
 * - Custom scrollbar styling
 * - Allows wheel events (doesn't block scroll)
 * 
 * Scrollbar Styling:
 * - Width: 8px
 * - Track: Semi-transparent surface
 * - Thumb: Primary color at 30%
 * - Hover: Enhanced opacity
 * 
 * States:
 * - [data-active='false']: Hidden (pointer-events none)
 * - [data-active='true']: Visible with backdrop
 * - [data-state='enter']: Slide-in animation
 * - [data-state='exit']: Slide-out animation
 * 
 * Mobile Responsive:
 * - ≤768px: Full width (100vw)
 * - Border-radius: 0 (full edge)
 * - Header padding adjusted
 * 
 * Accessibility:
 * - Focus trap (implemented in component)
 * - Escape key to close
 * - Focus-visible outlines
 * - ARIA modal attributes
 * 
 * Performance:
 * - pointer-events: none when hidden
 * - transform-based animations (GPU)
 * - will-change hints during animation
 * - Backdrop-filter for glass effect
 * 
 * Browser Compatibility:
 * - backdrop-filter: Chrome 76+, Safari 9+ (-webkit), Firefox 103+
 * - color-mix(): Chrome 111+, Safari 16.2+, Firefox 113+
 * - Modern browsers (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)
 * 
 * @layer components
 */

/* ========== CONTACT ASIDE - RIGHT SIDEBAR ========== */
:root {
  --contact-aside-width: clamp(300px, 38vw, 480px);
}

.contact-aside-wrapper {
  position: fixed;
  inset: 0;
  display: flex;
  justify-content: flex-end;
  z-index: var(--z-offcanvas);
  pointer-events: none;
}

.contact-aside-backdrop {
  position: absolute;
  inset: 0;
  background: color-mix(in srgb, var(--color-backdrop, #0a0d12) 68%, transparent);
  -webkit-backdrop-filter: blur(4px) saturate(140%);
  backdrop-filter: blur(4px) saturate(140%);
  opacity: 0;
  transition: opacity 0.35s ease;
  pointer-events: auto;
}

.contact-aside-wrapper[data-active='true'] .contact-aside-backdrop {
  opacity: 1;
}

.contact-aside {
  position: relative;
  padding: 0;
  width: var(--contact-aside-width);
  background: var(--color-surface-elevated, var(--color-surface));
  border-left: 1px solid var(--color-border-subtle);
  box-shadow: var(--shadow-panel);
  transform: translateX(8%);
  opacity: 0;
  display: flex;
  flex-direction: column;
  border-radius: 8px 0 0 8px;
  pointer-events: auto;
}

.contact-aside[data-state='enter'] {
  animation: contact-aside-enter 0.55s var(--ease-spring, cubic-bezier(0.4, 0.7, 0.25, 1)) forwards;
}

.contact-aside[data-state='exit'] {
  animation: contact-aside-exit 0.4s var(--ease-spring, cubic-bezier(0.5, 0.3, 0.4, 1)) forwards;
}

@keyframes contact-aside-enter {
  from {
    opacity: 0;
    transform: translateX(18%) scale(0.94);
  }
  60% {
    opacity: 1;
  }
  to {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
}

@keyframes contact-aside-exit {
  from {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateX(14%) scale(var(--transform-scale-active));
  }
}

@media (prefers-reduced-motion: reduce) {
  .contact-aside.entering,
  .contact-aside.exiting {
    animation: none;
  }
  
  .contact-aside.entering {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
  
  .contact-aside.exiting {
    opacity: 0;
  }
}

.contact-aside__header {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: 0.85rem 1rem;
  border-radius: var(--radius-md) 0 0 var(--radius-md);
  border-bottom: 1px solid var(--color-border-subtle);
  min-height: 3.25rem;
  -webkit-backdrop-filter: blur(10px) saturate(160%);
  backdrop-filter: blur(10px) saturate(160%);
  background: linear-gradient(135deg, color-mix(in srgb, var(--color-primary) 24%, transparent), transparent);
  position: sticky;
  top: 0;
  z-index: 5;
}

.contact-aside__title {
  font-size: clamp(1.05rem, 1.4vw, 1.4rem);
  font-weight: 600;
  letter-spacing: 0.5px;
  margin: 0;
  color: var(--color-text);
}

.contact-aside__close-btn {
  margin-left: auto;
  background: transparent;
  border: 0;
  font-size: 1.25rem;
  cursor: pointer;
  color: var(--color-text-soft);
  line-height: 1;
  padding: 0.35rem 0.55rem;
  border-radius: var(--radius-sm, 6px);
  transition: background 0.25s ease, color 0.25s ease, transform 0.25s ease;
}

.contact-aside__close-btn:hover,
.contact-aside__close-btn:focus-visible {
  color: var(--color-text);
  background: color-mix(in srgb, var(--color-primary) 20%, transparent);
  outline: none;
}

.contact-aside__close-btn:active {
  transform: scale(0.9);
}


.contact-aside__body {
  flex: 1 1 0%;
  min-height: 0;
  padding: var(--space-5, 1.25rem) var(--space-5, 1.25rem) calc(var(--space-5, 1.25rem) + var(--space-6, 1.5rem));
  overflow-y: auto !important;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  height: auto;
}

.contact-aside__body::-webkit-scrollbar {
  width: 12px;
}

.contact-aside__body::-webkit-scrollbar-track {
  background: transparent;
}

.contact-aside__body::-webkit-scrollbar-thumb {
  background: color-mix(in srgb, var(--color-primary) 25%, transparent);
  border-radius: 40px;
  border: 3px solid var(--color-surface-elevated, var(--color-surface));
}

.contact-aside__body:hover::-webkit-scrollbar-thumb {
  background: color-mix(in srgb, var(--color-primary) 40%, transparent);
}

.contact-aside__subtitle {
  color: var(--color-text-soft);
  font-size: 1.05rem;
  line-height: 1.6;
  margin: 0 0 2rem 0;
}


.contact-aside__body::before,
.contact-aside__body::after {
  content: "";
  position: sticky;
  left: 0;
  right: 0;
  height: 3.2rem;
  pointer-events: none;
  z-index: 3;
}

.contact-aside__body::before {
  top: 0;
  background: linear-gradient(to bottom, var(--color-surface-elevated, var(--color-surface)) 60%, transparent);
}

.contact-aside__body::after {
  bottom: 0;
  background: linear-gradient(to top, var(--color-surface-elevated, var(--color-surface)) 60%, transparent);
}

[data-theme='dark'] .contact-aside {
  box-shadow: var(--shadow-panel);
}

[data-theme='contrast'] .contact-aside {
  background: #000;
  border-left: 2px solid var(--color-text);
}

/* ========== RESPONSIVE ========== */
@media (max-width: 840px) {
  :root {
    --contact-aside-width: clamp(300px, 90vw, 640px);
  }

  .contact-aside {
    border-radius: 0;
  }

  .contact-aside__header {
    padding: 0.75rem 0.85rem;
  }

  .contact-aside__title {
    font-size: clamp(1rem, 4.5vw, 1.25rem);
  }

  .contact-aside__body {
    padding: var(--space-4, 1rem) var(--space-4, 1rem) calc(var(--space-6, 1.5rem) + env(safe-area-inset-bottom, 0px));
  }

  .contact-aside__subtitle {
    font-size: 1rem;
    margin-bottom: 1.5rem;
  }
}

@media (max-width: 520px) {
  .contact-aside__body {
    padding: var(--space-4, 1rem) var(--space-3, 0.75rem) calc(var(--space-5, 1.25rem) + env(safe-area-inset-bottom, 0px));
  }

  .contact-aside__subtitle {
    font-size: 0.95rem;
  }
}
